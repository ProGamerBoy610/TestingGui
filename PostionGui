-- PSX Auto Farm GUI (Remote-based)
-- Sends all your pets to every active coin using "Join Coin"

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local coinsFolder = workspace:WaitForChild("__THINGS"):WaitForChild("Coins")
local petsFolder = workspace.__THINGS.__INSTANCE_CONTAINER.ActivePets

-- === GUI Setup ===
local screenGui = Instance.new("ScreenGui", playerGui)
screenGui.Name = "PSXAutoFarmGUI"

local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0, 20, 0, 20)
frame.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
frame.Active = true
frame.Draggable = true

local toggleButton = Instance.new("TextButton", frame)
toggleButton.Size = UDim2.new(1, -20, 0, 40)
toggleButton.Position = UDim2.new(0, 10, 0, 10)
toggleButton.Text = "Auto Farm: OFF"
toggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.GothamBold
toggleButton.TextScaled = true

local statusLabel = Instance.new("TextLabel", frame)
statusLabel.Size = UDim2.new(1, -20, 0, 25)
statusLabel.Position = UDim2.new(0, 10, 0, 60)
statusLabel.Text = "Status: Inactive"
statusLabel.BackgroundTransparency = 1
statusLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
statusLabel.Font = Enum.Font.Gotham
statusLabel.TextScaled = true

-- === Farm Logic ===
local enabled = false
local isFarming = false

local function getPetNames()
    local names = {}
    for _, folder in ipairs(petsFolder:GetChildren()) do
        if folder.Name == player.Name then
            for _, pet in ipairs(folder:GetChildren()) do
                table.insert(names, pet.Name)
            end
        end
    end
    return names
end

local function autoFarm()
    if isFarming or not enabled then return end
    isFarming = true

    local petNames = getPetNames()
    if #petNames == 0 then
        statusLabel.Text = "Status: No pets found"
        isFarming = false
        return
    end

    for _, coin in ipairs(coinsFolder:GetChildren()) do
        if not enabled then break end
        if coin:IsA("Model") and coin:FindFirstChild("Coin") then
            local success = pcall(function()
                ReplicatedStorage.Network.Invoke:InvokeServer("Join Coin", coin.Name, petNames)
            end)
            if success then
                statusLabel.Text = "Status: Farming..."
            end
            wait(0.3)
        end
    end

    isFarming = false
end

-- === Toggle Logic ===
toggleButton.MouseButton1Click:Connect(function()
    enabled = not enabled

    if enabled then
        toggleButton.Text = "Auto Farm: ON"
        toggleButton.BackgroundColor3 = Color3.fromRGB(50, 220, 50)
        statusLabel.Text = "Status: Active"

        RunService.Heartbeat:Connect(function()
            if enabled and not isFarming then
                autoFarm()
            end
        end)
    else
        toggleButton.Text = "Auto Farm: OFF"
        toggleButton.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
        statusLabel.Text = "Status: Inactive"
    end
end)

print("âœ… PSX Auto Farm GUI Loaded.")
