local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "FruitStealerGUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 420, 0, 250)
mainFrame.Position = UDim2.new(0.5, -210, 0.5, -125)
mainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 23)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
mainFrame.Active = true
mainFrame.Draggable = true

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

local stroke = Instance.new("UIStroke")
stroke.Color = Color3.fromRGB(64, 224, 208)
stroke.Thickness = 2
stroke.Parent = mainFrame

local glow = Instance.new("ImageLabel")
glow.Name = "Glow"
glow.Size = UDim2.new(1, 40, 1, 40)
glow.Position = UDim2.new(0, -20, 0, -20)
glow.BackgroundTransparency = 1
glow.Image = "rbxasset://textures/ui/GuiImagePlaceholder.png"
glow.ImageColor3 = Color3.fromRGB(64, 224, 208)
glow.ImageTransparency = 0.9
glow.Parent = mainFrame

local titleBar = Instance.new("Frame")
titleBar.Name = "TitleBar"
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.Position = UDim2.new(0, 0, 0, 0)
titleBar.BackgroundColor3 = Color3.fromRGB(32, 178, 170)
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleCorner = Instance.new("UICorner")
titleCorner.CornerRadius = UDim.new(0, 12)
titleCorner.Parent = titleBar

local titleGradient = Instance.new("UIGradient")
titleGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(72, 209, 204)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(64, 224, 208))
}
titleGradient.Rotation = 45
titleGradient.Parent = titleBar

local titleText = Instance.new("TextLabel")
titleText.Name = "TitleText"
titleText.Size = UDim2.new(1, -50, 1, 0)
titleText.Position = UDim2.new(0, 15, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "ðŸŽ Item Copier"
titleText.TextColor3 = Color3.fromRGB(255, 255, 255)
titleText.TextScaled = true
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Font = Enum.Font.GothamBold
titleText.Parent = titleBar

local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 5)
closeButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
closeButton.BorderSizePixel = 0
closeButton.Text = "âœ•"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextScaled = true
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(0, 15)
closeCorner.Parent = closeButton

local leftPanel = Instance.new("Frame")
leftPanel.Name = "LeftPanel"
leftPanel.Size = UDim2.new(0, 130, 1, -50)
leftPanel.Position = UDim2.new(0, 10, 0, 45)
leftPanel.BackgroundColor3 = Color3.fromRGB(28, 28, 35)
leftPanel.BorderSizePixel = 0
leftPanel.Parent = mainFrame

local leftCorner = Instance.new("UICorner")
leftCorner.CornerRadius = UDim.new(0, 8)
leftCorner.Parent = leftPanel

local leftStroke = Instance.new("UIStroke")
leftStroke.Color = Color3.fromRGB(45, 45, 55)
leftStroke.Thickness = 1
leftStroke.Parent = leftPanel

local playerLabel = Instance.new("TextLabel")
playerLabel.Name = "PlayerLabel"
playerLabel.Size = UDim2.new(1, -10, 0, 25)
playerLabel.Position = UDim2.new(0, 5, 0, 8)
playerLabel.BackgroundTransparency = 1
playerLabel.Text = "ðŸ‘¤ Target Player"
playerLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
playerLabel.TextScaled = true
playerLabel.TextXAlignment = Enum.TextXAlignment.Left
playerLabel.Font = Enum.Font.Gotham
playerLabel.Parent = leftPanel

local playerDropdown = Instance.new("TextButton")
playerDropdown.Name = "PlayerDropdown"
playerDropdown.Size = UDim2.new(1, -10, 0, 30)
playerDropdown.Position = UDim2.new(0, 5, 0, 35)
playerDropdown.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
playerDropdown.BorderSizePixel = 0
playerDropdown.Text = "Select Player â–¼"
playerDropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
playerDropdown.TextScaled = true
playerDropdown.Font = Enum.Font.Gotham
playerDropdown.Parent = leftPanel

local dropdownCorner = Instance.new("UICorner")
dropdownCorner.CornerRadius = UDim.new(0, 6)
dropdownCorner.Parent = playerDropdown

local playerList = Instance.new("ScrollingFrame")
playerList.Name = "PlayerList"
playerList.Size = UDim2.new(1, -10, 0, 90)
playerList.Position = UDim2.new(0, 5, 0, 70)
playerList.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
playerList.BorderSizePixel = 0
playerList.ScrollBarThickness = 3
playerList.Visible = false
playerList.Parent = leftPanel

local listCorner = Instance.new("UICorner")
listCorner.CornerRadius = UDim.new(0, 6)
listCorner.Parent = playerList

local listLayout = Instance.new("UIListLayout")
listLayout.SortOrder = Enum.SortOrder.Name
listLayout.Padding = UDim.new(0, 2)
listLayout.Parent = playerList

local refreshButton = Instance.new("TextButton")
refreshButton.Name = "RefreshButton"
refreshButton.Size = UDim2.new(1, -10, 0, 30)
refreshButton.Position = UDim2.new(0, 5, 1, -35)
refreshButton.BackgroundColor3 = Color3.fromRGB(108, 117, 125)
refreshButton.BorderSizePixel = 0
refreshButton.Text = "ðŸ”„ Refresh"
refreshButton.TextColor3 = Color3.fromRGB(255, 255, 255)
refreshButton.TextScaled = true
refreshButton.Font = Enum.Font.Gotham
refreshButton.Parent = leftPanel

local refreshCorner = Instance.new("UICorner")
refreshCorner.CornerRadius = UDim.new(0, 6)
refreshCorner.Parent = refreshButton

local rightPanel = Instance.new("Frame")
rightPanel.Name = "RightPanel"
rightPanel.Size = UDim2.new(1, -155, 1, -50)
rightPanel.Position = UDim2.new(0, 145, 0, 45)
rightPanel.BackgroundColor3 = Color3.fromRGB(28, 28, 35)
rightPanel.BorderSizePixel = 0
rightPanel.Parent = mainFrame

local rightCorner = Instance.new("UICorner")
rightCorner.CornerRadius = UDim.new(0, 8)
rightCorner.Parent = rightPanel

local rightStroke = Instance.new("UIStroke")
rightStroke.Color = Color3.fromRGB(45, 45, 55)
rightStroke.Thickness = 1
rightStroke.Parent = rightPanel

local itemsHeader = Instance.new("Frame")
itemsHeader.Name = "ItemsHeader"
itemsHeader.Size = UDim2.new(1, 0, 0, 30)
itemsHeader.Position = UDim2.new(0, 0, 0, 0)
itemsHeader.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
itemsHeader.BorderSizePixel = 0
itemsHeader.Parent = rightPanel

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 8)
headerCorner.Parent = itemsHeader

local itemsTitle = Instance.new("TextLabel")
itemsTitle.Name = "ItemsTitle"
itemsTitle.Size = UDim2.new(0.6, 0, 1, 0)
itemsTitle.Position = UDim2.new(0, 10, 0, 0)
itemsTitle.BackgroundTransparency = 1
itemsTitle.Text = "ðŸ“¦ Items"
itemsTitle.TextColor3 = Color3.fromRGB(100, 200, 255)
itemsTitle.TextScaled = true
itemsTitle.TextXAlignment = Enum.TextXAlignment.Left
itemsTitle.Font = Enum.Font.Gotham
itemsTitle.Parent = itemsHeader

local itemsCounter = Instance.new("TextLabel")
itemsCounter.Name = "ItemsCounter"
itemsCounter.Size = UDim2.new(0.4, -10, 1, 0)
itemsCounter.Position = UDim2.new(0.6, 0, 0, 0)
itemsCounter.BackgroundTransparency = 1
itemsCounter.Text = "0 items"
itemsCounter.TextColor3 = Color3.fromRGB(64, 224, 208)
itemsCounter.TextScaled = true
itemsCounter.TextXAlignment = Enum.TextXAlignment.Right
itemsCounter.Font = Enum.Font.GothamBold
itemsCounter.Parent = itemsHeader

local itemsScrollFrame = Instance.new("ScrollingFrame")
itemsScrollFrame.Name = "ItemsScrollFrame"
itemsScrollFrame.Size = UDim2.new(1, -8, 1, -70)
itemsScrollFrame.Position = UDim2.new(0, 4, 0, 35)
itemsScrollFrame.BackgroundColor3 = Color3.fromRGB(22, 22, 28)
itemsScrollFrame.BorderSizePixel = 0
itemsScrollFrame.ScrollBarThickness = 3
itemsScrollFrame.Parent = rightPanel

local itemsScrollCorner = Instance.new("UICorner")
itemsScrollCorner.CornerRadius = UDim.new(0, 6)
itemsScrollCorner.Parent = itemsScrollFrame

local itemsListLayout = Instance.new("UIListLayout")
itemsListLayout.SortOrder = Enum.SortOrder.Name
itemsListLayout.Padding = UDim.new(0, 3)
itemsListLayout.Parent = itemsScrollFrame

local stealAllButton = Instance.new("TextButton")
stealAllButton.Name = "StealAllButton"
stealAllButton.Size = UDim2.new(1, -8, 0, 30)
stealAllButton.Position = UDim2.new(0, 4, 1, -35)
stealAllButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
stealAllButton.BorderSizePixel = 0
stealAllButton.Text = "ðŸ“‹ Copy All Items"
stealAllButton.TextColor3 = Color3.fromRGB(255, 255, 255)
stealAllButton.TextScaled = true
stealAllButton.Font = Enum.Font.GothamBold
stealAllButton.Parent = rightPanel

local stealAllCorner = Instance.new("UICorner")
stealAllCorner.CornerRadius = UDim.new(0, 6)
stealAllCorner.Parent = stealAllButton

local currentSelectedPlayer = nil
local dropdownOpen = false

local function createPlayerOption(targetPlayer)
    local option = Instance.new("TextButton")
    option.Name = "Option_" .. targetPlayer.Name
    option.Size = UDim2.new(1, -6, 0, 22)
    option.BackgroundColor3 = Color3.fromRGB(55, 55, 65)
    option.BorderSizePixel = 0
    option.Text = targetPlayer.Name
    option.TextColor3 = Color3.fromRGB(255, 255, 255)
    option.TextScaled = true
    option.TextXAlignment = Enum.TextXAlignment.Left
    option.Font = Enum.Font.Gotham
    option.Parent = playerList
    
    local optionCorner = Instance.new("UICorner")
    optionCorner.CornerRadius = UDim.new(0, 4)
    optionCorner.Parent = option
    
    option.MouseEnter:Connect(function()
        option.BackgroundColor3 = Color3.fromRGB(64, 224, 208)
    end)
    
    option.MouseLeave:Connect(function()
        option.BackgroundColor3 = Color3.fromRGB(55, 55, 65)
    end)
    
    option.MouseButton1Click:Connect(function()
        selectPlayer(targetPlayer)
        toggleDropdown()
    end)
    
    return option
end

function selectPlayer(targetPlayer)
    currentSelectedPlayer = targetPlayer
    playerDropdown.Text = targetPlayer.Name .. " â–¼"
    itemsTitle.Text = "ðŸ“¦ " .. targetPlayer.Name
    refreshItems()
end

function toggleDropdown()
    dropdownOpen = not dropdownOpen
    playerList.Visible = dropdownOpen
    playerDropdown.Text = dropdownOpen and (currentSelectedPlayer and currentSelectedPlayer.Name .. " â–²" or "Select Player â–²") or (currentSelectedPlayer and currentSelectedPlayer.Name .. " â–¼" or "Select Player â–¼")
end

local function createItemFrame(tool, index)
    local itemFrame = Instance.new("Frame")
    itemFrame.Name = "ItemFrame_" .. index
    itemFrame.Size = UDim2.new(1, -8, 0, 35)
    itemFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    itemFrame.BorderSizePixel = 0
    itemFrame.Parent = itemsScrollFrame
    
    local itemCorner = Instance.new("UICorner")
    itemCorner.CornerRadius = UDim.new(0, 6)
    itemCorner.Parent = itemFrame
    
    local itemStroke = Instance.new("UIStroke")
    itemStroke.Color = Color3.fromRGB(50, 50, 60)
    itemStroke.Thickness = 1
    itemStroke.Parent = itemFrame
    
    local toolName = Instance.new("TextLabel")
    toolName.Name = "ToolName"
    toolName.Size = UDim2.new(1, -70, 1, 0)
    toolName.Position = UDim2.new(0, 10, 0, 0)
    toolName.BackgroundTransparency = 1
    toolName.Text = "ðŸ”§ " .. tool.Name
    toolName.TextColor3 = Color3.fromRGB(255, 255, 255)
    toolName.TextScaled = true
    toolName.TextXAlignment = Enum.TextXAlignment.Left
    toolName.Font = Enum.Font.Gotham
    toolName.Parent = itemFrame
    
    local stealButton = Instance.new("TextButton")
    stealButton.Name = "StealButton"
    stealButton.Size = UDim2.new(0, 55, 0, 25)
    stealButton.Position = UDim2.new(1, -60, 0, 5)
    stealButton.BackgroundColor3 = Color3.fromRGB(64, 224, 208)
    stealButton.BorderSizePixel = 0
    stealButton.Text = "Copy"
    stealButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    stealButton.TextScaled = true
    stealButton.Font = Enum.Font.GothamBold
    stealButton.Parent = itemFrame
    
    local stealButtonCorner = Instance.new("UICorner")
    stealButtonCorner.CornerRadius = UDim.new(0, 4)
    stealButtonCorner.Parent = stealButton
    
    stealButton.MouseButton1Click:Connect(function()
        local success, err = pcall(function()
            local clonedTool = tool:Clone()
            clonedTool.Parent = player.Backpack
        end)
        
        if success then
            stealButton.Text = "âœ“"
            stealButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
            wait(1)
            stealButton.Text = "Copy"
            stealButton.BackgroundColor3 = Color3.fromRGB(64, 224, 208)
        else
            stealButton.Text = "âœ—"
            stealButton.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
            wait(1)
            stealButton.Text = "Copy"
            stealButton.BackgroundColor3 = Color3.fromRGB(64, 224, 208)
        end
    end)
    
    return itemFrame
end

function refreshItems()
    for _, child in pairs(itemsScrollFrame:GetChildren()) do
        if child:IsA("Frame") and child.Name:match("ItemFrame_") then
            child:Destroy()
        end
    end
    
    if not currentSelectedPlayer then
        itemsCounter.Text = "0 items"
        return
    end
    
    local backpack = currentSelectedPlayer:FindFirstChild("Backpack")
    if not backpack then
        itemsCounter.Text = "No backpack"
        return
    end
    
    local tools = {}
    for _, item in pairs(backpack:GetChildren()) do
        if item:IsA("Tool") or item:IsA("HopperBin") then
            table.insert(tools, item)
        end
    end
    
    for i, tool in ipairs(tools) do
        createItemFrame(tool, i)
    end
    
    itemsCounter.Text = #tools .. " items"
    itemsScrollFrame.CanvasSize = UDim2.new(0, 0, 0, #tools * 38)
end

local function refreshPlayerList()
    for _, child in pairs(playerList:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end
    
    local players = Players:GetPlayers()
    for _, p in ipairs(players) do
        createPlayerOption(p)
    end
    
    playerList.CanvasSize = UDim2.new(0, 0, 0, #players * 24)
    
    if #players > 0 then
        playerDropdown.Text = "Select Player â–¼"
    else
        playerDropdown.Text = "No players"
    end
end

local function stealAllItems()
    if not currentSelectedPlayer then return end
    
    local backpack = currentSelectedPlayer:FindFirstChild("Backpack")
    if not backpack then return end
    
    local tools = {}
    for _, item in pairs(backpack:GetChildren()) do
        if item:IsA("Tool") or item:IsA("HopperBin") then
            table.insert(tools, item)
        end
    end
    
    local stolenCount = 0
    for _, tool in ipairs(tools) do
        local success, err = pcall(function()
            local clonedTool = tool:Clone()
            clonedTool.Parent = player.Backpack
            stolenCount = stolenCount + 1
        end)
    end
    
    stealAllButton.Text = "âœ“ Copied " .. stolenCount
    stealAllButton.BackgroundColor3 = Color3.fromRGB(25, 135, 84)
    wait(2)
    stealAllButton.Text = "ðŸ“‹ Copy All Items"
    stealAllButton.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
end

closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

playerDropdown.MouseButton1Click:Connect(function()
    toggleDropdown()
end)

refreshButton.MouseButton1Click:Connect(function()
    refreshPlayerList()
    refreshItems()
end)

stealAllButton.MouseButton1Click:Connect(function()
    stealAllItems()
end)

screenGui.MouseButton1Click:Connect(function()
    if dropdownOpen then
        toggleDropdown()
    end
end)

Players.PlayerAdded:Connect(function()
    wait(1)
    refreshPlayerList()
end)

Players.PlayerRemoving:Connect(function(leavingPlayer)
    if currentSelectedPlayer == leavingPlayer then
        currentSelectedPlayer = nil
        itemsCounter.Text = "0 items"
        itemsTitle.Text = "ðŸ“¦ Items"
        refreshItems()
    end
    refreshPlayerList()
end)

refreshPlayerList()

UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.F3 then
        mainFrame.Visible = not mainFrame.Visible
    end
end)
